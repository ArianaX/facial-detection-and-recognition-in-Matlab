function [s]=lbp_img(img)%%前面已经做过resize,灰度，double
 in=img;
    [rows,cols]=size(in);
    r=rows+4;
    c=cols+4;
    A=zeros(r,c);
    r0=3:r-2;
    c0=3:c-2;
    A(r0,c0)=in;%扩充两个像素数
    alpha=0.5;
    beta=1-alpha;
    d0=A(r0,c0-2)-in;
    d2=A(r0+2,c0)-in;
    d4=A(r0,c0+2)-in;
    d6=A(r0-2,c0)-in;
    d1=alpha*A(r0+1,c0-1)+beta*A(r0+2,c0-2)-in;
    d3=alpha*A(r0+1,c0+1)+beta*A(r0+2,c0+2)-in;
    d5=alpha*A(r0-1,c0+1)+beta*A(r0-2,c0+2)-in;
    d7=alpha*A(r0-1,c0-1)+beta*A(r0-2,c0-2)-in;
    d=[d0(:),d1(:),d2(:),d3(:),d4(:),d5(:),d6(:),d7(:)];
    d_thred=d>=0;
    code=2.^(7:-1:0);
    code=code(:);
    img_code=d_thred*code;
    lbp_out=reshape(img_code,rows,cols);
    s=im2uint8(mat2gray(lbp_out));%S是可显示的图片
